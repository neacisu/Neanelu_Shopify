# ============================================
# Neanelu Shopify - Docker Compose Environment
# ============================================
# IMPORTANT:
# - Folosește EXCLUSIV acest fișier pentru Docker Compose (nu `.env`)
# - Scripturile repo-ului rulează `docker compose --env-file .env.compose ...`
#
# Setup:
#   cp .env.compose.example .env.compose
#   editează valorile necesare (în special domeniu + ACME + auth)

# ============================================
# Domain / Public ingress (Traefik)
# ============================================
APP_HOST=https://manager.neanelu.ro

# Hostname only (no scheme), used by Traefik host rules / services that require a domain
APP_HOSTNAME=manager.neanelu.ro
# Porturile expuse pe host (default 80/443). Dacă hostul are deja Nginx/Apache pe 80/443,
# poți seta temporar alte porturi pentru dev local.
TRAEFIK_HTTP_PORT=80
TRAEFIK_HTTPS_PORT=443

# Email folosit de Let's Encrypt (ACME)
TRAEFIK_ACME_EMAIL=admin@neanelu.ro

# Cert resolver name (traefik static config uses this)
TRAEFIK_CERT_RESOLVER=letsencrypt

# Traefik dashboard basic-auth users (format: user:hashedPassword)
# Generează hash (bcrypt) astfel:
#   docker run --rm httpd:2.4-alpine htpasswd -nbB admin 'PAROLA_TA'
# Apoi setezi întregul output aici.
# IMPORTANT: în fișierele `--env-file`, Docker Compose interpretează `$` pentru substituții.
# Pentru hash-urile bcrypt (care conțin `$`), dublează `$` -> `$$` în valoare.
TRAEFIK_DASHBOARD_USERS=

# ============================================
# Backend (apps/backend-worker)
# ============================================
PORT=65000
NODE_ENV=development

# Dacă portul 65000 este deja folosit pe host, poți schimba temporar portul public expus în dev override.
BACKEND_HOST_PORT=65000

# Shopify (required for OAuth/Webhooks)
SHOPIFY_API_KEY=
SHOPIFY_API_SECRET=
SCOPES=read_products,write_products

# Crypto
ENCRYPTION_KEY_VERSION=1
ENCRYPTION_KEY_256=

# ============================================
# Data services
# ============================================
POSTGRES_USER=n3an37u
POSTGRES_PASSWORD=change_me
POSTGRES_DB=shopify_neanelu_2025

# NOTE: în containere folosim hostnames `db` și `redis`
# Pentru un workflow "docker-first", acest fișier servește și ca sursă pentru scripturile rulate pe host
# (ex: `pnpm db:migrate`). De aceea păstrăm URL-urile de host pe localhost.
DATABASE_URL=postgresql://n3an37u:change_me@localhost:65010/shopify_neanelu_2025
REDIS_URL=redis://localhost:65011

# URL-uri interne (folosite DOAR de containere)
DATABASE_URL_DOCKER=postgresql://n3an37u:change_me@db:5432/shopify_neanelu_2025
REDIS_URL_DOCKER=redis://redis:6379

# ============================================
# Admin tools (dev)
# ============================================
PGADMIN_EMAIL=admin@local.dev
PGADMIN_PASSWORD=admin

# Grafana (admin)
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=change_me

# ============================================
# OpenTelemetry
# ============================================
# Backend exportă către collector (OTLP HTTP)
OTEL_SERVICE_NAME=neanelu-shopify
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:65022
OTEL_EXPORTER_OTLP_ENDPOINT_DOCKER=http://otel-collector:4318
OTEL_SAMPLING_RATIO=1.0
OBS_DEBUG=0

# ============================================
# BullMQ Pro (registry privat + runtime)
# ============================================
NPM_TASKFORCESH_TOKEN=
BULLMQ_PRO_TOKEN=
